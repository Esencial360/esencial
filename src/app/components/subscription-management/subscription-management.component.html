@if (subscriptionStatusLoaded) { 
<div   
  class="max-w-2xl mx-auto my-16 relative overflow-hidden"
  data-aos="fade-up"
  data-aos-duration="1000" 
>
  <!-- Background container with enhanced styling -->
  <div class="relative bg-gradient-to-br from-white via-gray-50/50 to-white p-10 rounded-3xl border-white/20 montserrat-normal">
    

    
    <div class="relative z-10 text-center">
      @if (hasActiveSubscription) {
      
      <!-- Active subscription header -->
      <div class="mb-8">
        <div class="inline-flex items-center px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 rounded-full text-white text-sm font-medium mb-4 shadow-lg">
          <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
          </svg>
          Suscripción Activa
        </div>
        
        <h2 class="text-3xl lg:text-4xl font-bold bg-gradient-to-r from-strongBrown via-blue to-strongBrown bg-clip-text text-transparent uppercase mb-4">
          Tu Suscripción Actual
        </h2>
      </div>

      <!-- Subscription details with enhanced cards -->
      <div class="space-y-6 mb-8">
        
        <!-- Plan card -->
        <div class="bg-gradient-to-r from-blue/10 to-strongBrown/10 p-6 rounded-2xl border border-blue/20 hover:shadow-lg transition-all duration-300">
          <div class="flex items-center justify-between">
            <span class="text-lg text-strongBrown/80 font-medium">Plan actual:</span>
            <span class="text-xl font-bold bg-gradient-to-r from-blue to-strongBrown bg-clip-text text-transparent">
              {{getFallbackPlanName(subscription?.planName)}}
            </span>
          </div>
        </div>
        
        <!-- Next payment card -->
        <div class="bg-gradient-to-r from-amber-50 to-orange-50 p-6 rounded-2xl border border-amber-200 hover:shadow-lg transition-all duration-300">
          <div class="flex items-center justify-between">
            <span class="text-lg text-strongBrown/80 font-medium">Próximo pago:</span>
            <span class="text-lg font-bold text-amber-700">
              {{ subscription?.nextPaymentDate | date : "longDate" }}
            </span>
          </div>
        </div>
        
        <!-- Amount card -->
        <div class="bg-gradient-to-r from-emerald-50 to-green-50 p-6 rounded-2xl border border-emerald-200 hover:shadow-lg transition-all duration-300">
          <div class="flex items-center justify-between">
            <span class="text-lg text-strongBrown/80 font-medium">Monto:</span>
            <span class="text-2xl font-bold text-emerald-700">
              ${{ subscription?.amount / 100 }} USD
            </span>
          </div>
        </div>
        
      </div>

      <!-- Cancel button with enhanced styling -->
      <div class="mt-8">
        <button
          class="group relative overflow-hidden w-full py-4 px-6 bg-gradient-to-r from-ref to-orange hover:from-red-600 hover:to-red-700 text-white font-semibold rounded-2xl shadow-lg hover:shadow-xl transform hover:scale-[1.02] transition-all duration-300 [disabled]"
          (click)="cancelSubscription()"
          [disabled]="updating"
        >
          <!-- Button ripple effect -->
          <div class="absolute inset-0 bg-gradient-to-r from-red to-orange  group-hover:opacity-100 transition-opacity duration-300"></div>
          
          <!-- Button content -->
          <div class="relative flex items-center justify-center">
            <svg class="w-5 h-5 mr-3 group-hover:rotate-12 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            Cancelar Suscripción
          </div>
        </button>
      </div>
      
      } @else {
      
      <!-- No subscription state -->
      <div class="mb-8">
        <div class="inline-flex items-center px-6 py-3 bg-gradient-to-r from-blue to-stronger_blue rounded-full text-white text-sm font-medium mb-4 shadow-lg">
          <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
          </svg>
          Sin Suscripción
        </div>
        
        <h2 class="text-3xl lg:text-4xl font-bold text-strongBrown uppercase mb-4">
          Sin suscripción activa
        </h2>
        
        <p class="text-lg text-strongBrown/70 mb-8 leading-relaxed">
          Elige un plan para comenzar a disfrutar del contenido premium y desbloquear todas las funcionalidades.
        </p>
      </div>

      <!-- Subscribe button -->
      <button
        class="group relative overflow-hidden w-full py-4 px-8 bg-gradient-to-r from-blue to-strongBrown hover:from-strongBrown hover:to-blue text-white font-semibold rounded-2xl shadow-lg hover:shadow-xl transform hover:scale-[1.02] transition-all duration-300"
        (click)="subscribe()"
        [disabled]="updating"
      >
        <!-- Button glow effect -->
        <div class="absolute inset-0 bg-gradient-to-r from-strongBrown to-blue opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
        
        <!-- Button content -->
        <div class="relative flex items-center justify-center">
          <svg class="w-6 h-6 mr-3 group-hover:scale-110 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
          </svg>
          Suscribirse ahora
        </div>
        
        <!-- Shine effect -->
        <div class="absolute inset-0 -translate-x-full group-hover:translate-x-full bg-gradient-to-r from-transparent via-white/20 to-transparent transition-transform duration-1000 ease-out"></div>
      </button>
      
      }
    </div>
    
    <!-- Subtle animated border -->
    <div class="absolute inset-0 rounded-3xl bg-gradient-to-r from-blue/20 via-transparent to-strongBrown/20 opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none"></div>
  </div>
  
  <!-- Bottom decorative element -->
  <div class="flex justify-center mt-8">
    <div class="w-20 h-1 bg-gradient-to-r from-strongBrown via-blue to-strongBrown rounded-full opacity-60"></div>
  </div>
</div>

} @else { 

<!-- Loading state -->
<div   
  class="max-w-2xl mx-auto my-16 relative overflow-hidden"
  data-aos="fade-up"
  data-aos-duration="1000"
>
  <div class="relative bg-gradient-to-br from-white via-gray-50/50 to-white backdrop-blur-sm p-10 rounded-3xl shadow-2xl border border-white/20 montserrat-normal text-center">
    
    <!-- Loading background elements -->
    <div class="absolute top-0 right-0 w-32 h-32 bg-gradient-to-bl from-blue/5 to-transparent rounded-full animate-pulse"></div>
    <div class="absolute bottom-0 left-0 w-24 h-24 bg-gradient-to-tr from-strongBrown/5 to-transparent rounded-full animate-pulse"></div>
    
    <div class="relative z-10">
      <div class="inline-flex items-center px-6 py-3 bg-gradient-to-r from-gray-200 to-gray-300 rounded-full text-gray-600 text-sm font-medium mb-6 animate-pulse">
        <div class="w-5 h-5 mr-2 rounded-full bg-gray-400 animate-spin"></div>
        Cargando información...
      </div>
      
      <app-loading></app-loading>
    </div>
  </div>
</div>

}