<app-header></app-header>

<app-page-title
  [pageTitle]="blog?.title || 'Cargando...'"
  [pageDescription]="'Descubra los secretos del equilibrio entre alimentación y bienestar para una vida radiante.'"
  class="relative"
  [arrowBack]="true"
></app-page-title>

<main class="min-h-screen bg-gradient-to-br from-slate-50 via-blue-50/30 to-indigo-50/50">
  
  <!-- Loading State -->
  @if (isLoading) {
  <section class="min-h-[60vh] flex items-center justify-center px-4">
    <div class="text-center">
      <div class="w-16 h-16 mx-auto mb-4 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin"></div>
      <p class="text-gray-600 font-medium">Cargando artículo...</p>
    </div>
  </section>
  }

  <!-- Error State -->
  @if (hasError && !isLoading) {
  <section class="min-h-[60vh] flex items-center justify-center px-4">
    <div class="text-center max-w-md">
      <div class="w-24 h-24 mx-auto mb-8 bg-gradient-to-r from-red-100 to-orange-100 rounded-full flex items-center justify-center">
        <span class="material-symbols-outlined text-5xl text-red-600">error</span>
      </div>
      <h2 class="text-3xl font-bold text-gray-900 mb-4">Artículo no encontrado</h2>
      <p class="text-gray-600 mb-8 leading-relaxed">
        Lo sentimos, no pudimos encontrar el artículo que buscas. Puede que haya sido movido o eliminado.
      </p>
      <div class="flex flex-col sm:flex-row gap-3 justify-center">
        <button 
          (click)="goBack()"
          class="inline-flex items-center px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-xl transition-all duration-300 transform hover:scale-105">
          <span class="material-symbols-outlined mr-2">arrow_back</span>
          Volver atrás
        </button>
        <button 
          (click)="goHome()"
          class="inline-flex items-center px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-xl transition-all duration-300 transform hover:scale-105">
          <span class="material-symbols-outlined mr-2">home</span>
          Ir al inicio
        </button>
      </div>
    </div>
  </section>
  }

  <!-- Main Content -->
  @if (blog && !isLoading && !hasError) {
  <section class="relative overflow-hidden">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 lg:py-12">
      <article class="max-w-5xl mx-auto">
        
        <!-- Main Content Card -->
        <div class="bg-white/90 backdrop-blur-sm shadow-2xl rounded-3xl overflow-hidden border border-white/20 hover:shadow-3xl transition-all duration-500">
          
          <!-- Featured Image with Enhanced Overlay -->
          <div class="relative h-64 md:h-80 lg:h-96 overflow-hidden">
            <img
              [src]="blog.imageUrl || '../../../../assets/images/yoga1.jpg'"
              [alt]="blog.title"
              class="w-full h-full object-cover transform hover:scale-105 transition-transform duration-700"
              loading="lazy"
            />
            
            <!-- Enhanced gradient overlay -->
            <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent"></div>
            
            <!-- Top badges row -->
            <div class="absolute top-4 left-4 right-4 flex justify-between items-start">
              <!-- Category Badge -->
              <div class="flex flex-wrap gap-2">
                @if (blog.categoryId) {
                <span class="inline-flex items-center px-3 py-2 rounded-full text-sm font-semibold bg-blue-600/90 text-white backdrop-blur-md border border-white/20 shadow-lg">
                  <span class="material-symbols-outlined text-lg mr-2">{{getCategoryIcon(blog.categoryId)}}</span>
                  {{ blog.categoryId }}
                </span>
                }
                
                <!-- Tags -->
                @if (blog.tags && blog.tags.length > 0) {
                @for (tag of blog.tags.slice(0, 2); track $index) {
                <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-white/20 text-white backdrop-blur-sm border border-white/30">
                  #{{ tag }}
                </span>
                }
                }
              </div>

              <!-- Reading time and stats -->
              <div class="flex flex-col gap-2 items-end">
                <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-white/20 text-white backdrop-blur-md border border-white/30">
                  <span class="material-symbols-outlined text-sm mr-1">schedule</span>
                  {{ readingTime }} min lectura
                </span>
                <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-white/20 text-white backdrop-blur-md border border-white/30">
                  <span class="material-symbols-outlined text-sm mr-1">visibility</span>
                  {{ wordCount }} palabras
                </span>
              </div>
            </div>

            <!-- Title overlay on image -->
            <div class="absolute bottom-6 left-6 right-6">
              <h1 class="text-3xl md:text-4xl lg:text-5xl font-bold text-white leading-tight drop-shadow-2xl">
                {{ blog.title }}
              </h1>
            </div>
          </div>

          <!-- Content Section -->
          <div class="p-6 md:p-8 lg:p-12">
            
            <!-- Article Meta Information -->
            <header class="mb-8 pb-6 border-b border-gray-100">
              <div class="flex flex-wrap items-center justify-between gap-4 text-sm text-gray-600">
                <div class="flex flex-wrap items-center gap-6">
                  @if (blog.createdAt) {
                  <div class="flex items-center">
                    <span class="material-symbols-outlined mr-2 text-blue-600">calendar_today</span>
                    <time class="font-medium">{{ getFormattedDate(blog.createdAt) }}</time>
                  </div>
                  }
                  <div class="flex items-center">
                    <span class="material-symbols-outlined mr-2 text-green-600">verified</span>
                    <span class="font-medium">Contenido verificado</span>
                  </div>
                  <!-- <div class="flex items-center">
                    <span class="material-symbols-outlined mr-2 text-purple-600">favorite</span>
                    <span class="font-medium">{{ likesCount }} me gusta</span>
                  </div> -->
                </div>
                
                <!-- Quick Actions -->
                <div class="flex items-center gap-2">
                  <button 
                    (click)="printArticle()"
                    class="p-2 rounded-lg text-gray-600 hover:text-blue-600 hover:bg-blue-50 transition-all duration-200"
                    title="Imprimir artículo">
                    <span class="material-symbols-outlined">print</span>
                  </button>
                  <button 
                    (click)="shareArticle()"
                    class="p-2 rounded-lg text-gray-600 hover:text-blue-600 hover:bg-blue-50 transition-all duration-200"
                    title="Compartir artículo">
                    <span class="material-symbols-outlined">share</span>
                  </button>
                </div>
              </div>
            </header>

            <!-- Main Content Section with Enhanced Typography -->
            <section class="mb-10">
              <div class="flex items-center mb-8">
                <div class="flex-shrink-0">
                  <div class="w-14 h-14 bg-gradient-to-r from-blue to-stronger_blue rounded-2xl flex items-center justify-center shadow-lg">
                    <span class="material-symbols-outlined text-white text-2xl">article</span>
                  </div>
                </div>
                <div class="ml-4">
                  <h2 class="text-2xl font-bold text-gray-900">Contenido del Artículo</h2>
                  <p class="text-gray-600">Información detallada y actualizada</p>
                </div>
              </div>
              
              <!-- Enhanced TinyMCE Content Display -->
              <div class="tinymce-content">
                <div 
                  [innerHTML]="safeDescription"
                  class="prose prose-lg prose-blue max-w-none leading-relaxed">
                </div>
              </div>
            </section>

            <!-- Enhanced Action Buttons -->
            <div class="flex flex-col sm:flex-row gap-4 pt-8 border-t border-gray-100">
              <button 
                (click)="shareArticle()"
                [class]="'bg-gradient-to-r from-blue to-stronger_blue text-white hover:from-blue-700 hover:to-indigo-700'"
                class="flex-1 font-semibold py-4 px-6 rounded-2xl transition-all duration-300 transform hover:scale-105 hover:shadow-xl flex items-center justify-center">
                <!-- <span class="material-symbols-outlined mr-2" [class]="isLiked ? 'text-white' : ''">
                  {{ isLiked ? 'favorite' : 'favorite_border' }}
                </span>
                {{ isLiked ? '¡Te gusta!' : 'Me gusta este artículo' }}
                <span class="ml-2 bg-white/20 px-2 py-1 rounded-full text-sm">{{ likesCount }}</span> -->
                <span class="material-symbols-outlined mr-2 group-hover:text-blue-600 transition-colors duration-200">share</span>
                Compartir artículo
              </button>
              
              <!-- <button 
                (click)="shareArticle()"
                class="flex-1 bg-white hover:bg-gray-50 text-gray-700 font-semibold py-4 px-6 rounded-2xl border-2 border-gray-200 hover:border-blue-300 transition-all duration-300 flex items-center justify-center group">
                <span class="material-symbols-outlined mr-2 group-hover:text-blue-600 transition-colors duration-200">share</span>
                Compartir artículo
              </button> -->
            </div>

            <!-- Additional Engagement Section -->
            <!-- <div class="mt-8 p-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl border border-blue-100">
              <div class="flex items-center justify-between">
                <div>
                  <h3 class="text-lg font-semibold text-gray-900 mb-2">¿Te ha sido útil este contenido?</h3>
                  <p class="text-gray-600 text-sm">Tu opinión nos ayuda a mejorar</p>
                </div>
                <div class="flex gap-2">
                  <button class="px-4 py-2 bg-green-100 hover:bg-green-200 text-green-800 rounded-lg transition-all duration-200 flex items-center">
                    <span class="material-symbols-outlined mr-1">thumb_up</span>
                    Útil
                  </button>
                  <button class="px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-800 rounded-lg transition-all duration-200 flex items-center">
                    <span class="material-symbols-outlined mr-1">thumb_down</span>
                    No útil
                  </button>
                </div>
              </div>
            </div> -->
          </div>
        </div>

        <!-- Related Articles and Navigation -->
        <div class="mt-12 grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- Navigation -->
          <div class="bg-white/70 backdrop-blur-sm p-6 rounded-2xl border border-white/20 shadow-lg">
            <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
              <span class="material-symbols-outlined mr-2 text-blue-600">navigation</span>
              Navegación
            </h3>
            <div class="space-y-3">
              <button 
                (click)="goBack()"
                class="w-full flex items-center p-3 text-left text-gray-700 hover:bg-blue rounded-lg transition-all duration-200">
                <span class="material-symbols-outlined mr-3 text-gray-500">arrow_back</span>
                <div>
                  <div class="font-medium">Volver atrás</div>
                  <div class="text-sm text-gray-500">Regresar a la página anterior</div>
                </div>
              </button>
              <button 
                (click)="goHome()"
                class="w-full flex items-center p-3 text-left text-gray-700 hover:bg-blue rounded-lg transition-all duration-200">
                <span class="material-symbols-outlined mr-3 text-gray-500">home</span>
                <div>
                  <div class="font-medium">Ir al inicio</div>
                  <div class="text-sm text-gray-500">Ver todos los artículos</div>
                </div>
              </button>
            </div>
          </div>

          <!-- Suggested Actions -->
          <div class="bg-white/70 backdrop-blur-sm p-6 rounded-2xl border border-white/20 shadow-lg">
            <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
              <span class="material-symbols-outlined mr-2 text-green-600">lightbulb</span>
              Más contenido
            </h3>
            <div class="space-y-3">
              <button class="w-full flex items-center p-3 text-left text-gray-700 hover:bg-blue rounded-lg transition-all duration-200">
                <span class="material-symbols-outlined mr-3 text-gray-500">explore</span>
                <div>
                  <div class="font-medium">Explorar categorías</div>
                  <div class="text-sm text-gray-500">Descubre más temas de interés</div>
                </div>
              </button>
              <!-- <button class="w-full flex items-center p-3 text-left text-gray-700 hover:bg-green-50 rounded-lg transition-all duration-200">
                <span class="material-symbols-outlined mr-3 text-gray-500">bookmark</span>
                <div>
                  <div class="font-medium">Guardar para después</div>
                  <div class="text-sm text-gray-500">Añadir a tus favoritos</div>
                </div>
              </button> -->
            </div>
          </div>
        </div>
      </article>
    </div>
  </section>
  }
</main>

<app-footer></app-footer>