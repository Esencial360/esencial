
<app-header></app-header>
<div class="min-h-screen bg-gradient-to-br from-bone via-white to-veige/30 py-12 px-4 sm:px-6 lg:px-8">
  <div class="max-w-4xl mx-auto">
    
    <!-- Header -->
    <div class="mb-8">
      <button 
        (click)="cancel()"
        class="flex items-center text-strongBrown hover:text-lightBrown transition-colors duration-200 mb-4">
        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
        </svg>
        Volver
      </button>
      
      <h1 class="text-4xl font-bold text-strongBrown mb-2">
        {{ isEditMode ? 'Editar Clase de Zoom' : 'Nueva Clase de Zoom' }}
      </h1>
      <p class="text-gray">
        {{ isEditMode ? 'Actualiza la información de la clase' : 'Completa el formulario para crear una nueva clase en vivo' }}
      </p>
    </div>

    <!-- Alert Messages -->
    <div *ngIf="successMessage" class="mb-6 p-4 bg-green-50 border-l-4 border-green-500 rounded-lg animate-fade-in">
      <div class="flex items-center">
        <svg class="w-5 h-5 text-green-500 mr-3" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
        </svg>
        <p class="text-green-700 font-medium">{{ successMessage }}</p>
      </div>
    </div>

    <div *ngIf="errorMessage" class="mb-6 p-4 bg-red-50 border-l-4 border-red-500 rounded-lg animate-fade-in">
      <div class="flex items-center">
        <svg class="w-5 h-5 text-red-500 mr-3" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
        </svg>
        <p class="text-red-700 font-medium">{{ errorMessage }}</p>
      </div>
    </div>

    <!-- Form -->
    <form [formGroup]="zoomClassForm" (ngSubmit)="onSubmit()" class="bg-white rounded-3xl shadow-xl p-8 space-y-6">
      
      <!-- Title -->
      <div>
        <label for="title" class="block text-sm font-semibold text-strongBrown mb-2">
          Título de la Clase <span class="text-red">*</span>
        </label>
        <input
          type="text"
          id="title"
          formControlName="title"
          placeholder="Ej: Yoga Vinyasa para Principiantes"
          class="w-full px-4 py-3 border-2 rounded-xl focus:ring-2 focus:ring-blue focus:border-blue transition-all duration-200"
          [class.border-red]="isFieldInvalid('title')"
          [class.border-gray-300]="!isFieldInvalid('title')">
        <p *ngIf="isFieldInvalid('title')" class="mt-1 text-sm text-red">
          {{ getFieldError('title') }}
        </p>
      </div>

      <!-- Description -->
      <div>
        <label for="description" class="block text-sm font-semibold text-strongBrown mb-2">
          Descripción <span class="text-red">*</span>
        </label>
        <textarea
          id="description"
          formControlName="description"
          rows="4"
          placeholder="Describe la clase, qué se hará, y qué deben esperar los participantes..."
          class="w-full px-4 py-3 border-2 rounded-xl focus:ring-2 focus:ring-blue focus:border-blue transition-all duration-200 resize-none"
          [class.border-red]="isFieldInvalid('description')"
          [class.border-gray-300]="!isFieldInvalid('description')"></textarea>
        <p *ngIf="isFieldInvalid('description')" class="mt-1 text-sm text-red">
          {{ getFieldError('description') }}
        </p>
      </div>

      <!-- Instructor Name -->
      <div>
        <label for="instructorName" class="block text-sm font-semibold text-strongBrown mb-2">
          Nombre del Instructor <span class="text-red">*</span>
        </label>
        <input
          type="text"
          id="instructorName"
          formControlName="instructorName"
          placeholder="Ej: María González"
          class="w-full px-4 py-3 border-2 rounded-xl focus:ring-2 focus:ring-blue focus:border-blue transition-all duration-200"
          [class.border-red]="isFieldInvalid('instructorName')"
          [class.border-gray-300]="!isFieldInvalid('instructorName')">
        <p *ngIf="isFieldInvalid('instructorName')" class="mt-1 text-sm text-red">
          {{ getFieldError('instructorName') }}
        </p>
      </div>

      <!-- Zoom Link Section -->
      <div class="bg-blue/5 rounded-2xl p-6 space-y-4">
        <h3 class="text-lg font-bold text-strongBrown flex items-center">
          <svg class="w-6 h-6 mr-2 text-blue" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"/>
          </svg>
          Información de Zoom
        </h3>

        <!-- Zoom Link -->
        <div>
          <label for="zoomLink" class="block text-sm font-semibold text-strongBrown mb-2">
            Link de Zoom <span class="text-red">*</span>
          </label>
          <input
            type="url"
            id="zoomLink"
            formControlName="zoomLink"
            (blur)="extractMeetingIdFromLink()"
            placeholder="https://zoom.us/j/1234567890?pwd=..."
            class="w-full px-4 py-3 border-2 rounded-xl focus:ring-2 focus:ring-blue focus:border-blue transition-all duration-200 font-mono text-sm"
            [class.border-red]="isFieldInvalid('zoomLink')"
            [class.border-gray-300]="!isFieldInvalid('zoomLink')">
          <p *ngIf="isFieldInvalid('zoomLink')" class="mt-1 text-sm text-red">
            {{ getFieldError('zoomLink') }}
          </p>
          <p class="mt-1 text-xs text-gray">
            El link debe ser de formato: https://zoom.us/j/[meeting-id]
          </p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <!-- Meeting ID -->
          <div>
            <label for="meetingId" class="block text-sm font-semibold text-strongBrown mb-2">
              ID de Reunión (Opcional)
            </label>
            <input
              type="text"
              id="meetingId"
              formControlName="meetingId"
              placeholder="123 456 7890"
              class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-blue focus:border-blue transition-all duration-200">
          </div>

          <!-- Password -->
          <div>
            <label for="password" class="block text-sm font-semibold text-strongBrown mb-2">
              Contraseña (Opcional)
            </label>
            <input
              type="text"
              id="password"
              formControlName="password"
              placeholder="abc123"
              class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-blue focus:border-blue transition-all duration-200">
          </div>
        </div>
      </div>

      <!-- Date and Duration -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Scheduled Date -->
        <div>
          <label for="scheduledDate" class="block text-sm font-semibold text-strongBrown mb-2">
            Fecha y Hora <span class="text-red">*</span>
          </label>
          <input
            type="datetime-local"
            id="scheduledDate"
            formControlName="scheduledDate"
            class="w-full px-4 py-3 border-2 rounded-xl focus:ring-2 focus:ring-blue focus:border-blue transition-all duration-200"
            [class.border-red]="isFieldInvalid('scheduledDate')"
            [class.border-gray-300]="!isFieldInvalid('scheduledDate')">
          <p *ngIf="isFieldInvalid('scheduledDate')" class="mt-1 text-sm text-red">
            {{ getFieldError('scheduledDate') }}
          </p>
        </div>

        <!-- Duration -->
        <div>
          <label for="duration" class="block text-sm font-semibold text-strongBrown mb-2">
            Duración (minutos) <span class="text-red">*</span>
          </label>
          <input
            type="number"
            id="duration"
            formControlName="duration"
            min="15"
            max="180"
            step="15"
            class="w-full px-4 py-3 border-2 rounded-xl focus:ring-2 focus:ring-blue focus:border-blue transition-all duration-200"
            [class.border-red]="isFieldInvalid('duration')"
            [class.border-gray-300]="!isFieldInvalid('duration')">
          <p *ngIf="isFieldInvalid('duration')" class="mt-1 text-sm text-red">
            {{ getFieldError('duration') }}
          </p>
        </div>
      </div>

      <!-- Level and Category -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Level -->
        <div>
          <label for="level" class="block text-sm font-semibold text-strongBrown mb-2">
            Nivel <span class="text-red">*</span>
          </label>
          <select
            id="level"
            formControlName="level"
            class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-blue focus:border-blue transition-all duration-200">
            <option *ngFor="let level of levels" [value]="level">{{ level }}</option>
          </select>
        </div>

        <!-- Category -->
        <div>
          <label for="category" class="block text-sm font-semibold text-strongBrown mb-2">
            Categoría <span class="text-red">*</span>
          </label>
          <select
            id="category"
            formControlName="category"
            class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-blue focus:border-blue transition-all duration-200">
            <option *ngFor="let category of categories" [value]="category">{{ category }}</option>
          </select>
        </div>
      </div>

      <!-- Max Participants -->
      <div>
        <label for="maxParticipants" class="block text-sm font-semibold text-strongBrown mb-2">
          Máximo de Participantes <span class="text-red">*</span>
        </label>
        <input
          type="number"
          id="maxParticipants"
          formControlName="maxParticipants"
          min="1"
          class="w-full px-4 py-3 border-2 rounded-xl focus:ring-2 focus:ring-blue focus:border-blue transition-all duration-200"
          [class.border-red]="isFieldInvalid('maxParticipants')"
          [class.border-gray-300]="!isFieldInvalid('maxParticipants')">
        <p *ngIf="isFieldInvalid('maxParticipants')" class="mt-1 text-sm text-red">
          {{ getFieldError('maxParticipants') }}
        </p>
      </div>

      <!-- Form Actions -->
      <div class="flex flex-col sm:flex-row gap-4 pt-6 border-t-2 border-gray-100">
        <button
          type="button"
          (click)="cancel()"
          class="flex-1 px-6 py-3 bg-gray-100 text-strongBrown font-semibold rounded-xl hover:bg-gray-200 transition-all duration-200"
          [disabled]="loading">
          Cancelar
        </button>
        <button
          type="submit"
          class="flex-1 px-6 py-3 bg-gradient-to-r from-blue to-stronger_blue text-white font-semibold rounded-xl hover:from-stronger_blue hover:to-blue transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none"
          [disabled]="loading || zoomClassForm.invalid">
          <span *ngIf="!loading">
            {{ isEditMode ? 'Actualizar Clase' : 'Crear Clase' }}
          </span>
          <span *ngIf="loading" class="flex items-center justify-center">
            <svg class="animate-spin h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24">
              <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
              <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            Guardando...
          </span>
        </button>
      </div>
    </form>

  </div>
</div>
<app-footer></app-footer>